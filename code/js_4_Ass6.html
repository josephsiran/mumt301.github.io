<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Music APIs</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../css/main.css">
	<style>
		.output {
			font-size: 15px;
		}
	</style>
</head>

<body id="body">
	<div id="container">
		<h2>Assignment 6 Recap</h2>
		<p>Retrieve MBID for a given user-entered artist</p>

		<form id="artist"> Artist name?
			<input type="text" name="artist">
			<input type="button" onclick="artistMBIDRetriever()" value="Retrieve albums!">
		</form>
		<p></p>

    <div id="artistOutput" class="output"></div>

		<div class="center">
				<a href="../index.html">MUMT301 Home</a>
		</div>


		<script>
			function httpGet(theUrl) {
				var xmlHttp = new XMLHttpRequest();
				xmlHttp.open("GET", theUrl, false);
				xmlHttp.send();
				return xmlHttp.responseXML;
			}

			function artistMBIDRetriever() {
				// Retrieve the data from the form
				artistName = document.getElementById("artist")
				artistnameForm = document.getElementById("artist");
				artistName = artistnameForm.elements["artist"].value;

				// Create the MB call
				mbBaseURL = "https://musicbrainz.org/ws/2/";
				mbResource = "artist?query=";
				queryURL = mbBaseURL + mbResource + artistName;
				// console.log(queryURL);
				retrievedData = httpGet(queryURL);
				// console.log(retrievedData)

				// Parse the response from MB
				artistData = retrievedData.getElementsByTagName("artist")[0];
				artistMBID = artistData.id;
				// console.log(artistMBID);
				artistDocument = retrievedData.getElementById(artistMBID)
				artistName = artistDocument.getElementsByTagName("name")[0].innerHTML;
				artistCountry = artistDocument.getElementsByTagName("country")[0].innerHTML;
				console.log(artistName, artistCountry);

				// Rendering the results
				document.getElementById("artistOutput").innerHTML = artistName + " is from " + artistCountry + " and their MBID is " +  artistMBID;

				// // Attaching the results to the DOM
				// nameNode = document.createElement("p");
				// nameText = document.createTextNode(artistName);
				// nameNode.appendChild(nameText);
				//
				// countryNode = document.createElement("p");
				// countryText = document.createTextNode(artistCountry);
				// countryNode.appendChild(countryText);
				//
				// idNode = document.createElement("p");
				// idText = document.createTextNode(artistMBID);
				// idNode.appendChild(idText);
				//
				// document.getElementById("artistOutput").appendChild(nameNode);
				// document.getElementById("artistOutput").appendChild(countryNode);
				// document.getElementById("artistOutput").appendChild(idNode);


			}

		</script>
</body>
</html>
