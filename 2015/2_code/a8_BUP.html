
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>A8</title>
    <link rel="stylesheet" href="./css/a8.css">
    <script src="./js/jquery-1.11.3.js"></script>
</head>

<body>

    
    <h4>Enter the name of an artist you like:</h4>
    <form id="form">
        <input type="text" name="artistName" id="name">
        <input type="button" name="clickButton" onclick="fetchSimilar()" value="DO IT">
    </form>
    <h1 id="header" align="center"></h1>

    <div id="a1" class="division"></div>
    <div id="a2" class="division"></div>
    <div id="a3" class="division"></div>
    <div id="a4" class="division"></div>
    
    <script>

        function fetchSimilar(){
            var name = document.getElementById("name");
            var x = document.getElementById("form");
            var artistname = x.elements['name'].value;
            document.getElementById("header").innerHTML = ["Artists similar to", artistname,"are"].join(" ");

            var lastfmapiKey = '57ee3318536b23ee81d6b27e36997cde';
            var url = "https://ws.audioscrobbler.com/2.0/";
            var args = {
                method: "artist.getSimilar",
                api_key: lastfmapiKey,
                format: "json",
                artist: artistname,
                limit: 4
                };
        

            $.getJSON(url, args, 
                      function(data) {
                        // console.log(data);
                        var name = Array();
                        var imgURL = Array();
                        similarArtists = data.similarartists.artist
                        for ( a = 0; a < similarArtists.length ; a ++ ) {
                            thisArtist = similarArtists[a];
                            mbid = thisArtist['mbid'];
                            name = thisArtist['name'];
                            imgURL =  thisArtist['image'][2]['#text'];
                            thisdiv = ["#a", a + 1].join("");
                            bio = getBio(mbid, thisdiv);

                            $(thisdiv).empty();
                            $(thisdiv).append("<h3>" + name + "</h3>" + "<br>");            
                            $(thisdiv).append ('<img src="' + imgURL + '" align="center" style="padding:0px 15px 0px 0px"> ' + '<br>');

                        }
                    }
                )



        function getBio(mbid, thisdiv) {
            var url = 'http://developer.echonest.com/api/v4/artist/biographies';
            var apiKey = 'SIKZGGF4TKV8DL8TE';
            var bio;
            var thisdiv = thisdiv;
            var args = {
                format: 'json',
                api_key: apiKey,
                id: ["musicbrainz:artist:", mbid].join(""),
                license: 'cc-by-sa',
                results: 1
            };
            console.log('THISDIV1:' + thisdiv);
            $.getJSON(url, args,
                function(data) {
                    bio = data.response.biographies[0].text;
                    $(thisdiv).append(bio);
                }
            );
        }

    }
                
        
</script>
<div class="logos">
    <a href="http://the.echonest.com/">
        <img src="img/echonest.png" width=160px> </a>
        <a href="http://www.last.fm/">
        <img src="img/lastfm_black.png" width=40px> </a>
            
</div>

</body>
</html>

